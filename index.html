<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ekub</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <link href="https://use.fontawesome.com/releases/v6.0.0/css/all.css" rel="stylesheet"/>
</head>
<style>
    table {
  border: 1px solid #6eb4df;
  border-collapse: collapse;

}
/* .goog-te-banner-frame.skiptranslate, .goog-te-gadget-icon {
        display: none !important;
    }
    body {
        top: 0px !important;
    }
    .goog-tooltip {
        display: none !important;
    }
    .goog-tooltip:hover {
        display: none !important;
    }
    .goog-text-highlight {
        background-color: transparent !important;
        border: none !important;
        box-shadow: none !important;
    }
    .goog-te-banner-frame {
 left: -180px !important;
} */

.fa-refresh:hover{
font-size: large;
cursor: pointer;
  /* color: white; */

}
</style>
<body style="font-weight: 300;  font-size: 15px; height: auto;"> 
    
    <!-- <header>
        <span class="navbar-nav mr-sm-2" id="google_translate_element"></span>
    </header> -->
    
    <main>
        <div class="container d-flex flex-row justify-content-center align-content-center">
            <div class="row d-flex flex-row justify-content-center align-content-center">
                <div class="col-md-12 col-sm-10 my-2" style="border-radius: 50px; box-shadow: 0px 0px 10px #2f5c78; width: 400px;">
                    <div class="headder">
                        <h1 class="text-center py-3 text-success">የኛ ዕቁብ</h1> <img src="" alt="">
                    </div>
                </div>
            </div>
        </div>

        <div class="container-fluid  p-4 mb-4  was-validated" id="div">
            <div class="row">
                
                <!-- position fixed not working as intended -->
                
                <div class="col-md-6 needs-validation d-flex flex-column justify-content-center align-content-center left" style="height: auto; box-shadow: 10px 10px 0px px rgb(250, 247, 250); border-radius: 10px;" novalidate>
    <div id="alert" style="color: red;"></div>
                    
                    <h4 class="text-center text-success"> አባል ይሁኑ</h4>
                    <!-- Language ends here -->
                   

                    <form class="form-check" style="width: 70%;">

                        <!-- Choose Amount -->
                        
                    <div class="mb-1">
                        <label for="Name" class="form-label"> ሙሉ ስም</label>
                        <input type="text" class="form-control" id="name">
                        <!-- <div class="invalid-feedback">Invalid</div>
                        <div class="valid-feedback">Valid</div>
                         -->
                        </div>
                      <div class="mb-1">
                        <label for="PhoneNumber" class="form-label">ስልክ ቁጥር</label>
                        <input type="text" class="form-control" id="PhoneNumber" >
                      </div>

                      <div class="mb-1 mt-1">
                        <label for="IdCard" class="form-label">መታወቂያዎን እዚህ ይስቀሉ</label>
                        <input type="file" class="form-control" style="width: 100px;" placeholder="" id="uploadId">
                      </div>
                      
                      <div class="py-2">
                        <label for="Name" class="form-label px-2">የእቁብ መጠን ይምረጡ </label><br>

                    <select name="ekubs" id="ekubs" class="mb-2 mx-2 form-select-lg" style="width: 100%;">
            
                    </select>
                    </div>
                      
                      <div class="form-check mb-1 py-2 mx-2">
                        <input type="checkbox" class="form-check-input"  id="validationFormCheck1" style="cursor: pointer;">
                        <label class="form-check-label" for="validationFormCheck1" style="cursor: pointer;">ተስማምቻለሁ</label>
                        
                      </div>
                      
                      <button type="button" href="#members" class="btn btn-dark align-self-center mt-4 mb-3" value="submit"  id="add" style="width: 100px;">አስገባኝ</button>
                      </form>

                </div>

                    <!-- right -->
                    
                     <div class="col-md-6 col-sm-12 text-center py-5 right" id="members" style="box-shadow:  10px 9px 15px 0px #2f5c78; border-radius: 10px; height: auto; background:transparent;">
                        

                            <h5 class="mb-3 text-success">አባላቶች</h5>
                            <table class="table bg-light" style="width:100%; color: #0a4366; " id="info">
                                <tr>
                                  <th>ስም</th>
                                  <th >ስልክ ቁጥር</th>
                                  <th >Remove </th>
                                </tr>
                               
                              </table>
                              
                        <button id="check" class="btn btn-dark my-5" data-bs-toggle="modal" data-bs-target="#alert-modal">ዕጣ አዉጣ</button>
                    </div>
                                    
            </div>

        </div>
    </main>

    <!-- modal id = "alert-modal" and modal-body id="winner" -->

    <!-- Button trigger modal -->


<!-- Modal -->
<div class="modal fade" id="alert-modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">

      <div class="modal-header">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-header d-flex justify-content-center align-items-center" style="border: none !important;">
        <h1 class="modal-title fs-2" id="staticBackdropLabel"></h1>
      </div>

      <div class="modal-body" style="font-size: 16px; font-weight: 200 !important;" id="winner">
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-success" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

    </div>
  </div>
</div>

    <footer class="bottom-0 mt-5" style="box-shadow: 0 0 5px #214f6c; height: 50px;">
        <div class="container-fluid py-2" >
            <div class="row ">
                <div class="col-md-12 d-flex flex-row justify-content-start align-content-center">

            <label for="Name" class="form-label px-3"> ቋንቋ</label>
            <select name="language" id="language" class="form-select-md">
                </select>
            
                <div class=" mx-3 restart d-flex flex-row">

                <p>እንደገና ጀምር</p> <i class="mt-1 mx-3 fas fa-refresh" id="reload"></i>
                </div>
                <script src="translate.js"></script>



                <!-- <p style="font-size: 15; " class="align-self-end">Designed by Adane Hailu</p> -->
                </div>


            </div>


            
        </div>
    </footer>
    <!-- Upload Your Id-->
    <!-- critical KYC element -->

</div>

<script>

languages
var languages = [
  {
    value: "am",
    text: "አማርኛ"
  },
  {
    value: "en",
    text: "English"
  },
  {
    value: "ti",
    text: "ትግርኛ"
  }
];



let languageSelect = document.querySelector("#language");

for (const language of languages) {
  const option = document.createElement("option");
  option.value = language.value;
  option.text = language.text;
  languageSelect.appendChild(option);
}
// Translate the pages language

// Choose Equbs
var Equbs = [
  {
    value: 100,
    text: "ባለ መቶ"
  },
  {
    value: 500,
    text: "ባለ አምስት መቶ"
  },
  {
    value: 1000,
    text: "ባለ አንድ ሺ"
  }
];
let selectEqub = document.querySelector("#ekubs");

for (const Equb of Equbs) {
    const option = document.createElement("option");
    option.value = Equb.value;
    option.text = Equb.text;
    selectEqub.appendChild(option);
}




// Translate
function googleTranslateElementInit() {
      var translator = new google.translate.TranslateElement({
      pageLanguage: 'en',
      includedLanguages: 'en,zh-CN,zh-TW',

      layout: google.translate.TranslateElement.InlineLayout.SIMPLE
   }, 'google_translate_element');
}

// selectEqub.options[selectEqub.lenght-1].text = "Melon";

        let Add = document.querySelector('#add');
        // alert Btn
        let alertBtn = document.querySelector('#alert')
        let showAlert = document.createElement('showAlert');
        alertBtn.append(showAlert);
        // for the check button
        let checkWinner = document.querySelector('#check');
        
        let table = document.querySelector('#info');
        
        
        
        
        var ekub = {
          
          userList: [],
        };
        
        // Display the user Name and Amount 
        Add.onclick = function(){
          
          var Name = document.querySelector('#name').value;
          var PhoneNumber = document.querySelector('#PhoneNumber').value;
          let uploadId= document.querySelector("#uploadId").value;
          let checkbox = document.querySelector("#validationFormCheck1");
            let isChecked = checkbox.checked;

            // should be on input change
            setTimeout(() => {
                document.querySelector('.timeOut').remove();
            },5000);


            if(Name =='' || PhoneNumber ==''){
              showAlert.innerHTML = `
                                      <div class="alert  alert-dismissible fade show timeOut" role="alert">
                                        ስም ወይም ስልክ ቁጥር አልተሞላም!
                                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                                        </div>
                                        `
                
            }else if(isNaN(PhoneNumber)){
                showAlert.innerHTML = `<div class="alert  alert-dismissible fade show timeOut" role="alert">
                                        የተሳሳተ ስልክ ቁጥር አስገብተዋል !
                                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                                        </div>`
            }else if(!isChecked){
                showAlert.innerHTML = `<div class="alert  alert-dismissible fade show timeOut" role="alert">
                                            ለመቀጠል በውሉ መስማማት አለብዎት
                                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                                        </div>`
            }

            // else if (ekub.userList.length > 0) {
            //     if (Name == ekub.userList[0].Name) {
            //       showAlert.innerHTML = `
            //       <div class="alert  alert-dismissible fade show timeOut" role="alert">
            //                             <h5 class= "py-3 text-center" style="color:red">ተጠቃሚ አስቀድሞ በዝርዝሩ ውስጥ አለ።</h5>
            //                             <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            //                             </div>
            //                   `
            //     }
            //         }
            // else if(!uploadId){
            //     showAlert.innerHTML = `<div class="alert  alert-dismissible fade show timeOut" role="alert">
            //                             እባኮን መታወቂያዎን ይስቀሉ !
            //                             <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            //                             </div>`
            // }
             else{
                  ekub.userList.push({
                  Name: Name,
                  phone: PhoneNumber
                  });
            let row = table.insertRow(-1);
            var c = row.insertCell(0);
            var c1 = row.insertCell(1);
            var c2 = row.insertCell(2)
        // var c2 = row.insertCell(2);

            c.innerHTML = Name;
            c1.innerHTML = PhoneNumber;

            let removeBtn = document.createElement("button");
            removeBtn.textContent = "Leave";

            removeBtn.classList.add("btn");
            removeBtn.classList.add("btn-outline-danger");
            // let htmlMarkup = removeBtn.outerHTML;
            // c2.innerHTML = `${removeBtn}`;


            removeBtn.onclick = function(){
              let trElement = document.querySelector(".btn-outline-danger").closest("tr");

               // Get the user's name and phone number from the tr element.
  let name = trElement.querySelector("td:first-child").textContent;
  let phone = trElement.querySelector("td:nth-child(2)").textContent;

  // Remove the user from the ekub.userList array.
  let index = ekub.userList.indexOf(user => user.Name === name && user.phone === phone);
  ekub.userList.splice(index, 1);


  // Remove the tr element from the table.
              trElement.remove();
            }
            c2.appendChild(removeBtn);
           
            
                                    
                                }
                                

                                
                                
        }



let reloadBtn = document.querySelector("#reload");
reloadBtn.onclick = function(){
  // Clear the form.
  document.querySelector("#name").value = "";
  document.querySelector("#PhoneNumber").value = "";
  let checkbox = document.querySelector("#validationFormCheck1");
            let isChecked = checkbox.checked;

            checkbox.checked = false;
  // document.querySelector("#uploadId").value = "";

  // Remove everything from the ekub.userList array.
  ekub.userList = [];

  // Enable all disabled buttons.

  Add.disabled = false;
  checkWinner.disabled = false;

  let table = document.querySelector("#info");
  let rows = table.querySelectorAll("tr");
  for (let i = 1; i < rows.length; i++) {
    rows[i].remove();
  }


  row.innerHTML =""
}




// get TheRandom Winner and display 
checkWinner.onclick = function(){
            
            let rand = Math.floor(Math.random() * ekub.userList.length);
            let winner = ekub.userList[rand];
            let winnerName = String(winner.Name);

            const selectedEkub = selectEqub.options[selectEqub.selectedIndex].value;

            let MoneyAmount = ekub.userList.length * selectedEkub;
            var modal = document.querySelector(".modal");
            let modalTitle = document.querySelector(".modal-title");
            let displayWinner = document.querySelector("#winner");


        //     //  this should be on input change
            setTimeout(() => {
                document.querySelector('.timeOut').remove();
            },5000);

          

           if(ekub.userList.length < 2){
              displayWinner.innerHTML = `በዕቁብ ዝርዝር ውስጥ በቂ አባላት የሉም!`;
            }
            
             else
            {
   
              modalTitle.innerHTML = `🎉🎉እንኳን ደስ አሎት🎉🎉 `;
                    displayWinner.innerHTML = `<div class="p-3">
        <h5>ስም: <span style="color:green"> ${winnerName} <span> </h2>
        <h5 class= "py-3"> ጠቅላላ መጠን:  <span style="color:green"> ${MoneyAmount} </span></h3>
        </div>`

        Add.disabled = true;
        checkWinner.disabled = true;
            }

            

            
        }

        


    </script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
    </body>
</html>
